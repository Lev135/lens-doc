<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE Rank2Types #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span class="hs-cpp">

#ifdef TRUSTWORTHY
</span><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span> </span><span class="hs-comment">-- vector, hashable</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#include &quot;lens-common.h&quot;
</span><span>
</span><span id="line-12"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Module      :  Control.Lens.Indexed</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Copyright   :  (C) 2012-16 Edward Kmett</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- License     :  BSD-style (see the file LICENSE)</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Maintainer  :  Edward Kmett &lt;ekmett@gmail.com&gt;</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Stability   :  provisional</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Portability :  Rank2Types</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- (The classes in here need to be defined together for @DefaultSignatures@ to work.)</span><span>
</span><span id="line-22"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-23"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Lens.Indexed</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-comment">-- * Indexing</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-identifier">Indexable</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Conjoined</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Indexed</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;.</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;.&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator">.&gt;</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">selfIndex</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">reindexed</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">icompose</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">indexing</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">indexing64</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-comment">-- * Indexed Functors</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">FunctorWithIndex</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-comment">-- ** Indexed Functor Combinators</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">imapped</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-comment">-- * Indexed Foldables</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">FoldableWithIndex</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-comment">-- ** Indexed Foldable Combinators</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ifolded</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">iany</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">iall</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inone</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">none</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">itraverse_</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ifor_</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">imapM_</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">iforM_</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">iconcatMap</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ifind</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ifoldrM</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ifoldlM</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">itoList</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-comment">-- * Converting to Folds</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">withIndex</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">asIndex</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-comment">-- * Restricting by Index</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">indices</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">index</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-comment">-- * Indexed Traversables</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">TraversableWithIndex</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-comment">-- * Indexed Traversable Combinators</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">itraversed</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ifor</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">imapM</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">iforM</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">imapAccumR</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">imapAccumL</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-comment">-- * Indexed Folds with Reified Monoid</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ifoldMapBy</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ifoldMapByOf</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">-- * Indexed Traversals with Reified Applicative</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">itraverseBy</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">itraverseByOf</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Functor.WithIndex</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Foldable.WithIndex</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Traversable.WithIndex</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Lens.Fold</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Lens.Getter</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Lens.Internal.Fold</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Lens.Internal.Indexed</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Lens.Internal.Prelude</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Lens.Setter</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Lens.Traversal</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Lens.Type</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Reflection</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.HashMap.Lazy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HashMap</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.IntMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IntMap</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Map</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Sequence</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Vector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Vector</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.HashMap.Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">HashMap</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.IntMap</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">IntMap</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Sequence</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Seq</span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Vector</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Vector</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator">&lt;.&gt;</span><span class="hs-special">,</span><span> </span><span class="hs-operator">&lt;.</span><span class="hs-special">,</span><span> </span><span class="hs-operator">.&gt;</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- &gt;&gt;&gt; :set -XNoOverloadedStrings</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- &gt;&gt;&gt; import Control.Lens</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified Data.Map as Map</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Compose an 'Indexed' function with a non-indexed function.</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- Mnemonically, the @&lt;@ points to the indexing we want to preserve.</span><span>
</span><span id="line-116"></span><span class="hs-comment">--</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- &gt;&gt;&gt; let nestedMap = (fmap Map.fromList . Map.fromList) [(1, [(10, &quot;one,ten&quot;), (20, &quot;one,twenty&quot;)]), (2, [(30, &quot;two,thirty&quot;), (40,&quot;two,forty&quot;)])]</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- &gt;&gt;&gt; nestedMap^..(itraversed&lt;.itraversed).withIndex</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- [(1,&quot;one,ten&quot;),(1,&quot;one,twenty&quot;),(2,&quot;two,thirty&quot;),(2,&quot;two,forty&quot;)]</span><span>
</span><span id="line-120"></span><span class="hs-special">(</span><span class="hs-operator">&lt;.</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Indexable</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span>
</span><span id="line-121"></span><span class="hs-special">(</span><span class="hs-operator">&lt;.</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">indexed</span><span> </span><span class="hs-identifier">h</span><span>
</span><span id="line-122"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;.</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Compose a non-indexed function with an 'Indexed' function.</span><span>
</span><span id="line-125"></span><span class="hs-comment">--</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- Mnemonically, the @&gt;@ points to the indexing we want to preserve.</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- This is the same as @('.')@.</span><span>
</span><span id="line-129"></span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- @f '.' g@ (and @f '.&gt;' g@) gives you the index of @g@ unless @g@ is index-preserving, like a</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- 'Prism', 'Iso' or 'Equality', in which case it'll pass through the index of @f@.</span><span>
</span><span id="line-132"></span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- &gt;&gt;&gt; let nestedMap = (fmap Map.fromList . Map.fromList) [(1, [(10, &quot;one,ten&quot;), (20, &quot;one,twenty&quot;)]), (2, [(30, &quot;two,thirty&quot;), (40,&quot;two,forty&quot;)])]</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- &gt;&gt;&gt; nestedMap^..(itraversed.&gt;itraversed).withIndex</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- [(10,&quot;one,ten&quot;),(20,&quot;one,twenty&quot;),(30,&quot;two,thirty&quot;),(40,&quot;two,forty&quot;)]</span><span>
</span><span id="line-136"></span><span class="hs-special">(</span><span class="hs-operator">.&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">st</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">kab</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">st</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">kab</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span>
</span><span id="line-137"></span><span class="hs-special">(</span><span class="hs-operator">.&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">.&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | Use a value itself as its own index. This is essentially an indexed version of 'id'.</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- Note: When used to modify the value, this can break the index requirements assumed by 'indices' and similar,</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- so this is only properly an 'IndexedGetter', but it can be used as more.</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- 'selfIndex' ::&#160;'IndexedGetter' a a b</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-148"></span><span class="hs-identifier">selfIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Indexable</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">fb</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fb</span><span>
</span><span id="line-149"></span><span class="hs-identifier">selfIndex</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">indexed</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-150"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">selfIndex</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | Remap the index.</span><span>
</span><span id="line-153"></span><span class="hs-identifier">reindexed</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Indexable</span><span> </span><span class="hs-identifier">j</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">j</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span>
</span><span id="line-154"></span><span class="hs-identifier">reindexed</span><span> </span><span class="hs-identifier">ij</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">indexed</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">ij</span><span>
</span><span id="line-155"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">reindexed</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Composition of 'Indexed' functions.</span><span>
</span><span id="line-158"></span><span class="hs-comment">--</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- Mnemonically, the @\&lt;@ and @\&gt;@ points to the fact that we want to preserve the indices.</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- &gt;&gt;&gt; let nestedMap = (fmap Map.fromList . Map.fromList) [(1, [(10, &quot;one,ten&quot;), (20, &quot;one,twenty&quot;)]), (2, [(30, &quot;two,thirty&quot;), (40,&quot;two,forty&quot;)])]</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- &gt;&gt;&gt; nestedMap^..(itraversed&lt;.&gt;itraversed).withIndex</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- [((1,10),&quot;one,ten&quot;),((1,20),&quot;one,twenty&quot;),((2,30),&quot;two,thirty&quot;),((2,40),&quot;two,forty&quot;)]</span><span>
</span><span id="line-164"></span><span class="hs-special">(</span><span class="hs-operator">&lt;.&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Indexable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">j</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-identifier">j</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span>
</span><span id="line-165"></span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">&lt;.&gt;</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">icompose</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span>
</span><span id="line-166"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;.&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | Composition of 'Indexed' functions with a user supplied function for combining indices.</span><span>
</span><span id="line-169"></span><span class="hs-identifier">icompose</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Indexable</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">j</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-identifier">j</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span>
</span><span id="line-170"></span><span class="hs-identifier">icompose</span><span> </span><span class="hs-identifier">ijk</span><span> </span><span class="hs-identifier">istr</span><span> </span><span class="hs-identifier">jabst</span><span> </span><span class="hs-identifier">cab</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">istr</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">jabst</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">j</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">indexed</span><span> </span><span class="hs-identifier">cab</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">ijk</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">j</span><span>
</span><span id="line-171"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">icompose</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- Restricting by index</span><span>
</span><span id="line-175"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | This allows you to filter an 'IndexedFold', 'IndexedGetter', 'IndexedTraversal' or 'IndexedLens' based on a predicate</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- on the indices.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- &gt;&gt;&gt; [&quot;hello&quot;,&quot;the&quot;,&quot;world&quot;,&quot;!!!&quot;]^..traversed.indices even</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- [&quot;hello&quot;,&quot;world&quot;]</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- &gt;&gt;&gt; over (traversed.indices (&gt;0)) Prelude.reverse $ [&quot;He&quot;,&quot;was&quot;,&quot;stressed&quot;,&quot;o_O&quot;]</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- [&quot;He&quot;,&quot;saw&quot;,&quot;desserts&quot;,&quot;O_o&quot;]</span><span>
</span><span id="line-185"></span><span class="hs-identifier">indices</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Indexable</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Optical'</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-186"></span><span class="hs-identifier">indices</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">indexed</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-187"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">indices</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | This allows you to filter an 'IndexedFold', 'IndexedGetter', 'IndexedTraversal' or 'IndexedLens' based on an index.</span><span>
</span><span id="line-190"></span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- &gt;&gt;&gt; [&quot;hello&quot;,&quot;the&quot;,&quot;world&quot;,&quot;!!!&quot;]^?traversed.index 2</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- Just &quot;world&quot;</span><span>
</span><span id="line-193"></span><span class="hs-identifier">index</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Indexable</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Optical'</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-194"></span><span class="hs-identifier">index</span><span> </span><span class="hs-identifier">j</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Indexed</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">j</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">indexed</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-195"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">index</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- FunctorWithIndex</span><span>
</span><span id="line-200"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | The 'IndexedSetter' for a 'FunctorWithIndex'.</span><span>
</span><span id="line-203"></span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- If you don't need access to the index, then 'mapped' is more flexible in what it accepts.</span><span>
</span><span id="line-205"></span><span class="hs-identifier">imapped</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">FunctorWithIndex</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">IndexedSetter</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-206"></span><span class="hs-identifier">imapped</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">conjoined</span><span> </span><span class="hs-identifier">mapped</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isets</span><span> </span><span class="hs-identifier">imap</span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">imapped</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- FoldableWithIndex</span><span>
</span><span id="line-211"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | The 'IndexedFold' of a 'FoldableWithIndex' container.</span><span>
</span><span id="line-214"></span><span class="hs-comment">--</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- @'ifolded' '.' 'asIndex'@ is a fold over the keys of a 'FoldableWithIndex'.</span><span>
</span><span id="line-216"></span><span class="hs-comment">--</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- &gt;&gt;&gt; Data.Map.fromList [(2, &quot;hello&quot;), (1, &quot;world&quot;)]^..ifolded.asIndex</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- [1,2]</span><span>
</span><span id="line-219"></span><span class="hs-identifier">ifolded</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">FoldableWithIndex</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">IndexedFold</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-220"></span><span class="hs-identifier">ifolded</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">conjoined</span><span> </span><span class="hs-identifier">folded</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">phantom</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">getFolding</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">ifoldMap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Folding</span><span> </span><span class="hs-operator">#.</span><span> </span><span class="hs-identifier">indexed</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">ifolded</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- TraversableWithIndex</span><span>
</span><span id="line-225"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- | The 'IndexedTraversal' of a 'TraversableWithIndex' container.</span><span>
</span><span id="line-228"></span><span class="hs-identifier">itraversed</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">TraversableWithIndex</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">IndexedTraversal</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-229"></span><span class="hs-identifier">itraversed</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">conjoined</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">itraverse</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">indexed</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- Instances</span><span>
</span><span id="line-234"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-237"></span><span class="hs-pragma">&quot;itraversed -&gt; mapList&quot;</span><span>    </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">sets</span><span> </span><span class="hs-pragma">fmap</span><span>        </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">ASetter</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">a</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">b</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-238"></span><span class="hs-pragma">&quot;itraversed -&gt; imapList&quot;</span><span>   </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">isets</span><span> </span><span class="hs-pragma">imap</span><span>       </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">AnIndexedSetter</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">a</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">b</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-239"></span><span class="hs-pragma">&quot;itraversed -&gt; foldrList&quot;</span><span>  </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">foldring</span><span> </span><span class="hs-pragma">foldr</span><span>   </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Getting</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">a</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-240"></span><span class="hs-pragma">&quot;itraversed -&gt; ifoldrList&quot;</span><span> </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">ifoldring</span><span> </span><span class="hs-pragma">ifoldr</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">IndexedGetting</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">a</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-241"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-244"></span><span class="hs-pragma">&quot;itraversed -&gt; mapIntMap&quot;</span><span>    </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">sets</span><span> </span><span class="hs-pragma">IntMap.map</span><span>               </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">ASetter</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">IntMap</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">IntMap</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-245"></span><span class="hs-pragma">&quot;itraversed -&gt; imapIntMap&quot;</span><span>   </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">isets</span><span> </span><span class="hs-pragma">IntMap.mapWithKey</span><span>       </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">AnIndexedSetter</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">IntMap</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">IntMap</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-246"></span><span class="hs-pragma">&quot;itraversed -&gt; foldrIntMap&quot;</span><span>  </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">foldring</span><span> </span><span class="hs-pragma">IntMap.foldr</span><span>         </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Getting</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">IntMap</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-247"></span><span class="hs-pragma">&quot;itraversed -&gt; ifoldrIntMap&quot;</span><span> </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">ifoldring</span><span> </span><span class="hs-pragma">IntMap.foldrWithKey</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">IndexedGetting</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">IntMap</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-248"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-251"></span><span class="hs-pragma">&quot;itraversed -&gt; mapMap&quot;</span><span>    </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">sets</span><span> </span><span class="hs-pragma">Map.map</span><span>               </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">ASetter</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Map</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Map</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-252"></span><span class="hs-pragma">&quot;itraversed -&gt; imapMap&quot;</span><span>   </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">isets</span><span> </span><span class="hs-pragma">Map.mapWithKey</span><span>       </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">AnIndexedSetter</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Map</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Map</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-253"></span><span class="hs-pragma">&quot;itraversed -&gt; foldrMap&quot;</span><span>  </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">foldring</span><span> </span><span class="hs-pragma">Map.foldr</span><span>         </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Getting</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Map</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-254"></span><span class="hs-pragma">&quot;itraversed -&gt; ifoldrMap&quot;</span><span> </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">ifoldring</span><span> </span><span class="hs-pragma">Map.foldrWithKey</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">IndexedGetting</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Map</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-255"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-258"></span><span class="hs-pragma">&quot;itraversed -&gt; mapHashMap&quot;</span><span>    </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">sets</span><span> </span><span class="hs-pragma">HashMap.map</span><span>               </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">ASetter</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">HashMap</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">HashMap</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-259"></span><span class="hs-pragma">&quot;itraversed -&gt; imapHashMap&quot;</span><span>   </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">isets</span><span> </span><span class="hs-pragma">HashMap.mapWithKey</span><span>       </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">AnIndexedSetter</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">HashMap</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">HashMap</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-260"></span><span class="hs-pragma">&quot;itraversed -&gt; foldrHashMap&quot;</span><span>  </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">foldring</span><span> </span><span class="hs-pragma">HashMap.foldr</span><span>         </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Getting</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">HashMap</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-261"></span><span class="hs-pragma">&quot;itraversed -&gt; ifoldrHashMap&quot;</span><span> </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">ifoldring</span><span> </span><span class="hs-pragma">HashMap.foldrWithKey</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">IndexedGetting</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">HashMap</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-262"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-265"></span><span class="hs-pragma">&quot;itraversed -&gt; mapSeq&quot;</span><span>    </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">sets</span><span> </span><span class="hs-pragma">fmap</span><span>                    </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">ASetter</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Seq</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Seq</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-266"></span><span class="hs-pragma">&quot;itraversed -&gt; imapSeq&quot;</span><span>   </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">isets</span><span> </span><span class="hs-pragma">Seq.mapWithIndex</span><span>       </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">AnIndexedSetter</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Seq</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Seq</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-267"></span><span class="hs-pragma">&quot;itraversed -&gt; foldrSeq&quot;</span><span>  </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">foldring</span><span> </span><span class="hs-pragma">foldr</span><span>               </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Getting</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Seq</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-268"></span><span class="hs-pragma">&quot;itraversed -&gt; ifoldrSeq&quot;</span><span> </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">ifoldring</span><span> </span><span class="hs-pragma">Seq.foldrWithIndex</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">IndexedGetting</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Seq</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-269"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-272"></span><span class="hs-pragma">&quot;itraversed -&gt; mapVector&quot;</span><span>    </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">sets</span><span> </span><span class="hs-pragma">Vector.map</span><span>         </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">ASetter</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Vector</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Vector</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-273"></span><span class="hs-pragma">&quot;itraversed -&gt; imapVector&quot;</span><span>   </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">isets</span><span> </span><span class="hs-pragma">Vector.imap</span><span>       </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">AnIndexedSetter</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Vector</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Vector</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">;</span><span>
</span><span id="line-274"></span><span class="hs-pragma">&quot;itraversed -&gt; foldrVector&quot;</span><span>  </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">foldring</span><span> </span><span class="hs-pragma">Vector.foldr</span><span>   </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Getting</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Vector</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-275"></span><span class="hs-pragma">&quot;itraversed -&gt; ifoldrVector&quot;</span><span> </span><span class="hs-pragma">itraversed</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">ifoldring</span><span> </span><span class="hs-pragma">Vector.ifoldr</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">IndexedGetting</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Endo</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Vector</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">;</span><span>
</span><span id="line-276"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- Indexed Folds with Reified Monoid</span><span>
</span><span id="line-280"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-identifier">ifoldMapBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">FoldableWithIndex</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span>
</span><span id="line-283"></span><span class="hs-identifier">ifoldMapBy</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">reifyMonoid</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifoldMap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ReflectedMonoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-identifier">ifoldMapByOf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IndexedFold</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span>
</span><span id="line-286"></span><span class="hs-identifier">ifoldMapByOf</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">reifyMonoid</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifoldMapOf</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ReflectedMonoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-identifier">itraverseBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">TraversableWithIndex</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span class="hs-identifier">itraverseBy</span><span> </span><span class="hs-identifier">pur</span><span> </span><span class="hs-identifier">app</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">reifyApplicative</span><span> </span><span class="hs-identifier">pur</span><span> </span><span class="hs-identifier">app</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">itraverse</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ReflectedApplicative</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-identifier">itraverseByOf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IndexedTraversal</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-292"></span><span class="hs-identifier">itraverseByOf</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">pur</span><span> </span><span class="hs-identifier">app</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">reifyApplicative</span><span> </span><span class="hs-identifier">pur</span><span> </span><span class="hs-identifier">app</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">itraverseOf</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ReflectedApplicative</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span></pre></body></html>